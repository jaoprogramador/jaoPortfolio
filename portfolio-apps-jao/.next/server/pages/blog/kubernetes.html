<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Blog - Kubernetes para Microservicios con Spring</title><meta name="description" content="Kubernetes (K8s) es el estándar de facto para orquestar contenedores. Aprende qué es, cuándo conviene usarlo, ventajas y desventajas, y cómo orquestar una app de microservicios Spring paso a paso, con ejemplos y comandos básicos."/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/e99fcc8540a81b1c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e99fcc8540a81b1c.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f8f60675323764f2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f8f60675323764f2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-570070fdbf91d417.js" defer=""></script><script src="/_next/static/chunks/framework-75db3117d1377048.js" defer=""></script><script src="/_next/static/chunks/main-6d31f1caf3df54dd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5f8ee1ef90dcf6c7.js" defer=""></script><script src="/_next/static/chunks/94726e6d-c72a854d4bfca4da.js" defer=""></script><script src="/_next/static/chunks/144-4ce2b94271136310.js" defer=""></script><script src="/_next/static/chunks/996-f3cf67c2e3ac5e06.js" defer=""></script><script src="/_next/static/chunks/581-aae012922ce60763.js" defer=""></script><script src="/_next/static/chunks/941-38f6f1657998506c.js" defer=""></script><script src="/_next/static/chunks/924-dbd55959fd098bb5.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-c171fda68c6d5435.js" defer=""></script><script src="/_next/static/Zz3LZEO5X5sTtAn6OoiOA/_buildManifest.js" defer=""></script><script src="/_next/static/Zz3LZEO5X5sTtAn6OoiOA/_ssgManifest.js" defer=""></script><script src="/_next/static/Zz3LZEO5X5sTtAn6OoiOA/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="container mx-auto mt-10 cursor-none"><div class="block tablet:hidden mt-5"><div class="flex items-center justify-between p-2 laptop:p-0"><h1 class="font-medium p-2 laptop:p-0 link">JAO<!-- -->.<!-- --></h1><div class="flex items-center"><select class="ml-2 p-1 border rounded transition-all duration-300 ease-out
        bg-white text-black border-gray-300
        hover:scale-105 active:scale-100 cursor-none undefined"><option value="es">🇪🇸 Castellano<!-- --></option><option value="en" selected="">🇬🇧 English<!-- --></option><option value="eu">🇪🇺 Euskera<!-- --></option></select><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined"><img class="h-6" src="/images/sun.svg" alt="Toggle theme"/></button><button id="headlessui-popover-button-:R4n6:" type="button" aria-expanded="false"><img class="h-5" src="/images/menu.svg" alt="Menu toggle"/></button></div></div></div><div class="mt-10 hidden flex-row items-center justify-between sticky dark:text-white top-0 z-10 tablet:flex"><h1 class="font-medium cursor-pointer">JAO<!-- -->.<!-- --></h1><div class="flex"><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Home</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Work</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">About</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Blog</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Frameworks</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Resume</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Contact</button><select class="ml-2 p-1 border rounded transition-all duration-300 ease-out
        bg-white text-black border-gray-300
        hover:scale-105 active:scale-100 cursor-none undefined"><option value="es">🇪🇸 Castellano<!-- --></option><option value="en" selected="">🇬🇧 English<!-- --></option><option value="eu">🇪🇺 Euskera<!-- --></option></select></div></div><div class="mt-10 flex flex-col"><img class="w-full h-96 rounded-lg shadow-lg object-cover" src="/images/blogs/kubernetes.jpg" alt="Kubernetes para Microservicios con Spring"/><h1 class="mt-10 text-4xl mob:text-2xl laptop:text-6xl text-bold">Kubernetes para Microservicios con Spring</h1><h2 class="mt-2 text-xl max-w-4xl text-darkgray opacity-50">Del JAR al cluster: despliega, escala y observa tus microservicios con K8s</h2></div><div class="markdown-class"><h1>Kubernetes para Microservicios con Spring 🚢<!-- --></h1>
<!-- --><p>Kubernetes (K8s) es una <!-- --><strong>plataforma de orquestación de contenedores<!-- --></strong> que automatiza el <!-- --><strong>despliegue, escalado, resiliencia y actualización<!-- --></strong> de tus aplicaciones.<!-- --><br/>
<!-- -->Se integra como anillo al dedo con <!-- --><strong>microservicios en Spring Boot<!-- --></strong>, empaquetados en <!-- --><strong>Docker<!-- --></strong>.<!-- --></p>
<!-- --><hr/>
<!-- --><h2>✅ ¿Qué es y para qué sirve Kubernetes?<!-- --></h2>
<!-- --><ul>
<!-- --><li><strong>Programa contenedores<!-- --></strong> en un <!-- --><strong>cluster<!-- --></strong> de máquinas (nodos).<!-- --></li>
<!-- --><li>Gestiona <!-- --><strong>despliegues declarativos<!-- --></strong>, <!-- --><strong>autorreparación<!-- --></strong> (restarts), <!-- --><strong>escalado<!-- --></strong> (HPA), <!-- --><strong>rollouts<!-- --></strong> y <!-- --><strong>rollbacks<!-- --></strong>.<!-- --></li>
<!-- --><li>Proporciona <!-- --><strong>networking<!-- --></strong> consistente, <!-- --><strong>descubrimiento de servicios<!-- --></strong> y <!-- --><strong>configuración<!-- --></strong> centralizada.<!-- --></li>
<!-- --><li>Facilita <!-- --><strong>observabilidad<!-- --></strong> (métricas, logs, trazas) y <!-- --><strong>seguridad<!-- --></strong> (RBAC, policies).<!-- --></li>
<!-- --></ul>
<!-- --><p><strong>Úsalo para<!-- --></strong>: apps con múltiples servicios, alta disponibilidad, picos de carga, equipos independientes y CI/CD moderno.<!-- --></p>
<!-- --><hr/>
<!-- --><h2>🤔 ¿Cuándo usarlo y cuándo no?<!-- --></h2>
<!-- --><p><strong>Úsalo si:<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Tienes <!-- --><strong>varios microservicios<!-- --></strong> y necesitas <!-- --><strong>escalar<!-- --></strong> por componente.<!-- --></li>
<!-- --><li>Requieres <!-- --><strong>alta disponibilidad<!-- --></strong>, <!-- --><strong>rollouts<!-- --></strong> sin downtime y <!-- --><strong>multi-entorno<!-- --></strong>/multi-cloud.<!-- --></li>
<!-- --><li>Quieres <!-- --><strong>infra como código<!-- --></strong> y pipelines de <!-- --><strong>CI/CD<!-- --></strong> maduros.<!-- --></li>
<!-- --></ul>
<!-- --><p><strong>Piensa dos veces si:<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Tu app es <!-- --><strong>simple/monolítica<!-- --></strong> con bajo tráfico.<!-- --></li>
<!-- --><li><strong>Equipo pequeño<!-- --></strong> sin experiencia en contenedores/DevOps.<!-- --></li>
<!-- --><li>Un <!-- --><strong>PaaS<!-- --></strong> (Cloud Run, App Service, Heroku) o <!-- --><strong>FaaS<!-- --></strong> cubre tu caso más rápido y barato.<!-- --></li>
<!-- --></ul>
<!-- --><hr/>
<!-- --><h2>⚖️ Ventajas y desventajas<!-- --></h2>
<!-- --><h3>Ventajas<!-- --></h3>
<!-- --><ul>
<!-- --><li><strong>Portabilidad<!-- --></strong> entre clouds/on-prem.<!-- --></li>
<!-- --><li><strong>Escalado automático<!-- --></strong> y <!-- --><strong>resiliencia<!-- --></strong>.<!-- --></li>
<!-- --><li><strong>Rolling updates/rollbacks<!-- --></strong> declarativos.<!-- --></li>
<!-- --><li><strong>Aislamiento<!-- --></strong> por namespace y políticas.<!-- --></li>
<!-- --></ul>
<!-- --><h3>Desventajas<!-- --></h3>
<!-- --><ul>
<!-- --><li><strong>Curva de aprendizaje<!-- --></strong> y <!-- --><strong>complejidad operativa<!-- --></strong>.<!-- --></li>
<!-- --><li><strong>Coste<!-- --></strong> de cluster + observabilidad.<!-- --></li>
<!-- --><li>Requiere <!-- --><strong>disciplina<!-- --></strong> (recursos, seguridad, backups).<!-- --></li>
<!-- --></ul>
<!-- --><hr/>
<!-- --><h2>🧩 Conceptos clave (mini-glosario útil)<!-- --></h2>
<!-- --><ul>
<!-- --><li><strong>Cluster<!-- --></strong>: conjunto de nodos controlados por el <!-- --><strong>control plane<!-- --></strong>.<!-- --></li>
<!-- --><li><strong>Nodo<!-- --></strong>: máquina (VM/física) que ejecuta contenedores.<!-- --></li>
<!-- --><li><strong>Pod<!-- --></strong>: mínima unidad desplegable (uno o más contenedores).<!-- --></li>
<!-- --><li><strong>Deployment<!-- --></strong>: gestiona réplicas y actualizaciones de Pods.<!-- --></li>
<!-- --><li><strong>Service<!-- --></strong>: IP/puerto estable para acceder a Pods (ClusterIP/NodePort/LoadBalancer).<!-- --></li>
<!-- --><li><strong>Ingress<!-- --></strong>: reglas HTTP para exponer servicios con dominio/paths.<!-- --></li>
<!-- --><li><strong>ConfigMap/Secret<!-- --></strong>: config no sensible/sensible para inyectar en Pods.<!-- --></li>
<!-- --><li><strong>Volume/PersistentVolume<!-- --></strong>: datos persistentes.<!-- --></li>
<!-- --><li><strong>StatefulSet<!-- --></strong>: para cargas <!-- --><strong>stateful<!-- --></strong> (orden e identidad).<!-- --></li>
<!-- --><li><strong>HPA<!-- --></strong>: autoscaling por CPU/RAM/métricas personalizadas.<!-- --></li>
<!-- --><li><strong>DaemonSet<!-- --></strong>: 1 Pod por nodo (agentes).<!-- --></li>
<!-- --><li><strong>Job/CronJob<!-- --></strong>: trabajos batch/planificados.<!-- --></li>
<!-- --><li><strong>Namespace<!-- --></strong>: segmentación lógica.<!-- --></li>
<!-- --><li><strong>RBAC<!-- --></strong>: permisos por rol/usuario/SA.<!-- --></li>
<!-- --></ul>
<!-- --><hr/>
<!-- --><h2>🛠️ Preparación de microservicios Spring (previos recomendados)<!-- --></h2>
<!-- --><ul>
<!-- --><li>Añade <!-- --><strong>Spring Actuator<!-- --></strong> para <!-- --><code>/actuator/health<!-- --></code> (readiness/liveness).<!-- --></li>
<!-- --><li>Externaliza config (profiles, vars de entorno).<!-- --></li>
<!-- --><li>Empaqueta con <!-- --><strong>Docker<!-- --></strong> o <!-- --><strong>Jib<!-- --></strong> (sin Dockerfile).<!-- --></li>
<!-- --><li>Expone <!-- --><strong>métricas<!-- --></strong> (Micrometer/Prometheus) y <!-- --><strong>trazas<!-- --></strong> (OpenTelemetry).<!-- --></li>
<!-- --></ul>
<!-- --><hr/>
<!-- --><h2>🚀 Orquestar una app de microservicios Spring en Kubernetes (paso a paso)<!-- --></h2>
<!-- --><ol>
<!-- --><li>
<!-- --><p><strong>Conteneriza cada servicio<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Dockerfile típico:<!-- -->
<!-- --><pre><div style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-dockerfile" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token instruction" style="color:#8be9fd">FROM<!-- --></span><span class="token instruction"> eclipse-temurin:21-jre<!-- --></span><span>
<!-- --></span><span></span><span class="token instruction" style="color:#8be9fd">WORKDIR<!-- --></span><span class="token instruction"> /app<!-- --></span><span>
<!-- --></span><span></span><span class="token instruction" style="color:#8be9fd">COPY<!-- --></span><span class="token instruction"> target/app.jar app.jar<!-- --></span><span>
<!-- --></span><span></span><span class="token instruction" style="color:#8be9fd">EXPOSE<!-- --></span><span class="token instruction"> 8080<!-- --></span><span>
<!-- --></span><span></span><span class="token instruction" style="color:#8be9fd">ENTRYPOINT<!-- --></span><span class="token instruction"> [<!-- --></span><span class="token instruction" style="color:#50fa7b">&quot;java&quot;<!-- --></span><span class="token instruction">,<!-- --></span><span class="token instruction" style="color:#50fa7b">&quot;-jar&quot;<!-- --></span><span class="token instruction">,<!-- --></span><span class="token instruction" style="color:#50fa7b">&quot;/app/app.jar&quot;<!-- --></span><span class="token instruction">]<!-- --></span></code></div></pre>
<!-- --></li>
<!-- --><li>O usa <!-- --><strong>Jib<!-- --></strong> (sin Dockerfile).<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Crea un cluster local<!-- --></strong></p>
<!-- --><ul>
<!-- --><li><code>minikube start<!-- --></code>  ó  <!-- --><code>kind create cluster --name demo<!-- --></code></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Sube imágenes al registry<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Etiqueta y push (<!-- --><code>docker tag/push<!-- --></code>) a Docker Hub/GHCR o usa <!-- --><code>minikube image load<!-- --></code>.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Define manifiestos por servicio (IaC)<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Namespace, Deployment (recursos, probes), Service (ClusterIP), ConfigMap/Secret.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Exposición HTTP<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Instala un <!-- --><strong>Ingress Controller<!-- --></strong> (p. ej., NGINX) y crea un <!-- --><strong>Ingress<!-- --></strong> por dominio/path.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Base de datos<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Preferible <!-- --><strong>servicio gestionado<!-- --></strong> (cloud) o <!-- --><strong>StatefulSet<!-- --></strong> con PVC si corre en K8s.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Observabilidad<!-- --></strong></p>
<!-- --><ul>
<!-- --><li><strong>Prometheus/Grafana<!-- --></strong> (métricas), <!-- --><strong>Loki/ELK<!-- --></strong> (logs), <!-- --><strong>Jaeger/Tempo<!-- --></strong> (trazas).<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Autoscaling y recursos<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Define <!-- --><strong>requests/limits<!-- --></strong> y <!-- --><strong>HPA<!-- --></strong> por servicio.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>CI/CD<!-- --></strong></p>
<!-- --><ul>
<!-- --><li>Pipeline: build → test → image push → deploy (kubectl/Helm/Kustomize).<!-- --></li>
<!-- --><li>Considera <!-- --><strong>GitOps<!-- --></strong> con Argo CD.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Seguridad base<!-- --></strong></p>
<!-- --><ul>
<!-- --><li><strong>RBAC<!-- --></strong>, <!-- --><strong>NetworkPolicies<!-- --></strong>, <!-- --><strong>Pod Security Standards<!-- --></strong>, secrets cifrados.<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --></ol>
<!-- --><hr/>
<!-- --><h2>📦 Manifiestos de ejemplo (users-service)<!-- --></h2>
<!-- --><h3>Deployment + Service (con probes y recursos)<!-- --></h3>
<!-- --><pre><div style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-yaml" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token key" style="color:#f1fa8c">apiVersion<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> apps/v1
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">kind<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> Deployment
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">metadata<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">name<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users<!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span>deploy
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">labels<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">app<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">spec<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">replicas<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">2<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">selector<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token key" style="color:#f1fa8c">matchLabels<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">app<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">template<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token key" style="color:#f1fa8c">metadata<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>      <!-- --></span><span class="token key" style="color:#f1fa8c">labels<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">app<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token key" style="color:#f1fa8c">spec<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>      <!-- --></span><span class="token key" style="color:#f1fa8c">containers<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>        <!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">name<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users
<!-- --></span><span>          <!-- --></span><span class="token key" style="color:#f1fa8c">image<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> ghcr.io/org/users<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>1.0.0
<!-- --></span><span>          <!-- --></span><span class="token key" style="color:#f1fa8c">ports<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">containerPort<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">8080<!-- --></span><span>
<!-- --></span><span>          <!-- --></span><span class="token key" style="color:#f1fa8c">env<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">name<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> SPRING_PROFILES_ACTIVE
<!-- --></span><span>              <!-- --></span><span class="token key" style="color:#f1fa8c">value<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> k8s
<!-- --></span><span>            <!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">name<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> DB_URL
<!-- --></span><span>              <!-- --></span><span class="token key" style="color:#f1fa8c">valueFrom<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>                <!-- --></span><span class="token key" style="color:#f1fa8c">secretKeyRef<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>                  <!-- --></span><span class="token key" style="color:#f1fa8c">name<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users<!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span>secrets
<!-- --></span><span>                  <!-- --></span><span class="token key" style="color:#f1fa8c">key<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> db<!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span>url
<!-- --></span><span>          <!-- --></span><span class="token key" style="color:#f1fa8c">readinessProbe<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">httpGet<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">path<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> /actuator/health/readiness<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">port<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">8080<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">initialDelaySeconds<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">10<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">periodSeconds<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">5<!-- --></span><span>
<!-- --></span><span>          <!-- --></span><span class="token key" style="color:#f1fa8c">livenessProbe<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">httpGet<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">path<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> /actuator/health/liveness<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">port<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">8080<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">initialDelaySeconds<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">20<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">periodSeconds<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">10<!-- --></span><span>
<!-- --></span><span>          <!-- --></span><span class="token key" style="color:#f1fa8c">resources<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">requests<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">cpu<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&quot;200m&quot;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">memory<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&quot;256Mi&quot;<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>            <!-- --></span><span class="token key" style="color:#f1fa8c">limits<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>   <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">cpu<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&quot;500m&quot;<!-- --></span><span class="token" style="color:#f8f8f2">,<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">memory<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#50fa7b">&quot;512Mi&quot;<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span></span><span class="token" style="color:#f8f8f2">---<!-- --></span><span>
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">apiVersion<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> v1
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">kind<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> Service
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">metadata<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">name<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users<!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span>svc
<!-- --></span><span></span><span class="token key" style="color:#f1fa8c">spec<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">selector<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#f8f8f2">{<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">app<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> users <!-- --></span><span class="token" style="color:#f8f8f2">}<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">ports<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span>
<!-- --></span><span>    <!-- --></span><span class="token" style="color:#f8f8f2">-<!-- --></span><span> <!-- --></span><span class="token key" style="color:#f1fa8c">port<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">80<!-- --></span><span>
<!-- --></span><span>      <!-- --></span><span class="token key" style="color:#f1fa8c">targetPort<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> <!-- --></span><span class="token" style="color:#bd93f9">8080<!-- --></span><span>
<!-- --></span><span>  <!-- --></span><span class="token key" style="color:#f1fa8c">type<!-- --></span><span class="token" style="color:#f8f8f2">:<!-- --></span><span> ClusterIP<!-- --></span></code></div></pre></div><div class="mt-5 laptop:mt-40 p-2 laptop:p-0"><div><h1 class="text-2xl text-bold">Contact.</h1><div class="mt-10"><h1 class="text-3xl tablet:text-6xl laptop:text-6xl laptopl:text-8xl text-bold">LET&#x27;S WORK TOGETHER</h1><h1 class="text-3xl tablet:text-6xl laptop:text-6xl laptopl:text-8xl text-bold"></h1><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg bg-black text-white  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Schedule a call</button><div class="mt-10"><div class="undefined flex flex-wrap mob:flex-nowrap link"><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Github</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">LinkedIn</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Twitter</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Blog</button><button type="button" class="text-sm tablet:text-base p-1 laptop:p-2 m-1 laptop:m-2 rounded-lg hover:bg-slate-100  transition-all duration-300 ease-out hover:scale-105 active:scale-100 cursor-none undefined">Email</button></div></div></div></div></div><h1 class="text-sm text-bold mt-2 laptop:mt-10 p-2 laptop:p-0">Made With ❤ by<!-- --> <!-- --><a class="underline underline-offset-1" href="https://jaoportfolio.onrender.com/">Juan Arana Olalde</a></h1></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"date":"2025-08-29T17:00:00.000Z","slug":"kubernetes","preview":"Kubernetes (K8s) es el estándar de facto para orquestar contenedores. Aprende qué es, cuándo conviene usarlo, ventajas y desventajas, y cómo orquestar una app de microservicios Spring paso a paso, con ejemplos y comandos básicos.","title":"Kubernetes para Microservicios con Spring","tagline":"Del JAR al cluster: despliega, escala y observa tus microservicios con K8s","image":"/images/blogs/kubernetes.jpg","content":"# Kubernetes para Microservicios con Spring 🚢\r\n\r\nKubernetes (K8s) es una **plataforma de orquestación de contenedores** que automatiza el **despliegue, escalado, resiliencia y actualización** de tus aplicaciones.  \r\nSe integra como anillo al dedo con **microservicios en Spring Boot**, empaquetados en **Docker**.\r\n\r\n---\r\n\r\n## ✅ ¿Qué es y para qué sirve Kubernetes?\r\n\r\n- **Programa contenedores** en un **cluster** de máquinas (nodos).\r\n- Gestiona **despliegues declarativos**, **autorreparación** (restarts), **escalado** (HPA), **rollouts** y **rollbacks**.\r\n- Proporciona **networking** consistente, **descubrimiento de servicios** y **configuración** centralizada.\r\n- Facilita **observabilidad** (métricas, logs, trazas) y **seguridad** (RBAC, policies).\r\n\r\n**Úsalo para**: apps con múltiples servicios, alta disponibilidad, picos de carga, equipos independientes y CI/CD moderno.\r\n\r\n---\r\n\r\n## 🤔 ¿Cuándo usarlo y cuándo no?\r\n\r\n**Úsalo si:**\r\n- Tienes **varios microservicios** y necesitas **escalar** por componente.\r\n- Requieres **alta disponibilidad**, **rollouts** sin downtime y **multi-entorno**/multi-cloud.\r\n- Quieres **infra como código** y pipelines de **CI/CD** maduros.\r\n\r\n**Piensa dos veces si:**\r\n- Tu app es **simple/monolítica** con bajo tráfico.\r\n- **Equipo pequeño** sin experiencia en contenedores/DevOps.\r\n- Un **PaaS** (Cloud Run, App Service, Heroku) o **FaaS** cubre tu caso más rápido y barato.\r\n\r\n---\r\n\r\n## ⚖️ Ventajas y desventajas\r\n\r\n### Ventajas\r\n- **Portabilidad** entre clouds/on-prem.\r\n- **Escalado automático** y **resiliencia**.\r\n- **Rolling updates/rollbacks** declarativos.\r\n- **Aislamiento** por namespace y políticas.\r\n\r\n### Desventajas\r\n- **Curva de aprendizaje** y **complejidad operativa**.\r\n- **Coste** de cluster + observabilidad.\r\n- Requiere **disciplina** (recursos, seguridad, backups).\r\n\r\n---\r\n\r\n## 🧩 Conceptos clave (mini-glosario útil)\r\n\r\n- **Cluster**: conjunto de nodos controlados por el **control plane**.\r\n- **Nodo**: máquina (VM/física) que ejecuta contenedores.\r\n- **Pod**: mínima unidad desplegable (uno o más contenedores).\r\n- **Deployment**: gestiona réplicas y actualizaciones de Pods.\r\n- **Service**: IP/puerto estable para acceder a Pods (ClusterIP/NodePort/LoadBalancer).\r\n- **Ingress**: reglas HTTP para exponer servicios con dominio/paths.\r\n- **ConfigMap/Secret**: config no sensible/sensible para inyectar en Pods.\r\n- **Volume/PersistentVolume**: datos persistentes.\r\n- **StatefulSet**: para cargas **stateful** (orden e identidad).\r\n- **HPA**: autoscaling por CPU/RAM/métricas personalizadas.\r\n- **DaemonSet**: 1 Pod por nodo (agentes).\r\n- **Job/CronJob**: trabajos batch/planificados.\r\n- **Namespace**: segmentación lógica.\r\n- **RBAC**: permisos por rol/usuario/SA.\r\n\r\n---\r\n\r\n## 🛠️ Preparación de microservicios Spring (previos recomendados)\r\n\r\n- Añade **Spring Actuator** para `/actuator/health` (readiness/liveness).\r\n- Externaliza config (profiles, vars de entorno).  \r\n- Empaqueta con **Docker** o **Jib** (sin Dockerfile).\r\n- Expone **métricas** (Micrometer/Prometheus) y **trazas** (OpenTelemetry).\r\n\r\n---\r\n\r\n## 🚀 Orquestar una app de microservicios Spring en Kubernetes (paso a paso)\r\n\r\n1. **Conteneriza cada servicio**\r\n   - Dockerfile típico:\r\n     ```dockerfile\r\n     FROM eclipse-temurin:21-jre\r\n     WORKDIR /app\r\n     COPY target/app.jar app.jar\r\n     EXPOSE 8080\r\n     ENTRYPOINT [\"java\",\"-jar\",\"/app/app.jar\"]\r\n     ```\r\n   - O usa **Jib** (sin Dockerfile).\r\n\r\n2. **Crea un cluster local**\r\n   - `minikube start`  ó  `kind create cluster --name demo`\r\n\r\n3. **Sube imágenes al registry**\r\n   - Etiqueta y push (`docker tag/push`) a Docker Hub/GHCR o usa `minikube image load`.\r\n\r\n4. **Define manifiestos por servicio (IaC)**\r\n   - Namespace, Deployment (recursos, probes), Service (ClusterIP), ConfigMap/Secret.\r\n\r\n5. **Exposición HTTP**\r\n   - Instala un **Ingress Controller** (p. ej., NGINX) y crea un **Ingress** por dominio/path.\r\n\r\n6. **Base de datos**\r\n   - Preferible **servicio gestionado** (cloud) o **StatefulSet** con PVC si corre en K8s.\r\n\r\n7. **Observabilidad**\r\n   - **Prometheus/Grafana** (métricas), **Loki/ELK** (logs), **Jaeger/Tempo** (trazas).\r\n\r\n8. **Autoscaling y recursos**\r\n   - Define **requests/limits** y **HPA** por servicio.\r\n\r\n9. **CI/CD**\r\n   - Pipeline: build → test → image push → deploy (kubectl/Helm/Kustomize).\r\n   - Considera **GitOps** con Argo CD.\r\n\r\n10. **Seguridad base**\r\n    - **RBAC**, **NetworkPolicies**, **Pod Security Standards**, secrets cifrados.\r\n\r\n---\r\n\r\n## 📦 Manifiestos de ejemplo (users-service)\r\n\r\n### Deployment + Service (con probes y recursos)\r\n```yaml\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: users-deploy\r\n  labels: { app: users }\r\nspec:\r\n  replicas: 2\r\n  selector:\r\n    matchLabels: { app: users }\r\n  template:\r\n    metadata:\r\n      labels: { app: users }\r\n    spec:\r\n      containers:\r\n        - name: users\r\n          image: ghcr.io/org/users:1.0.0\r\n          ports:\r\n            - containerPort: 8080\r\n          env:\r\n            - name: SPRING_PROFILES_ACTIVE\r\n              value: k8s\r\n            - name: DB_URL\r\n              valueFrom:\r\n                secretKeyRef:\r\n                  name: users-secrets\r\n                  key: db-url\r\n          readinessProbe:\r\n            httpGet: { path: /actuator/health/readiness, port: 8080 }\r\n            initialDelaySeconds: 10\r\n            periodSeconds: 5\r\n          livenessProbe:\r\n            httpGet: { path: /actuator/health/liveness, port: 8080 }\r\n            initialDelaySeconds: 20\r\n            periodSeconds: 10\r\n          resources:\r\n            requests: { cpu: \"200m\", memory: \"256Mi\" }\r\n            limits:   { cpu: \"500m\", memory: \"512Mi\" }\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: users-svc\r\nspec:\r\n  selector: { app: users }\r\n  ports:\r\n    - port: 80\r\n      targetPort: 8080\r\n  type: ClusterIP\r\n"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"kubernetes"},"buildId":"Zz3LZEO5X5sTtAn6OoiOA","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>