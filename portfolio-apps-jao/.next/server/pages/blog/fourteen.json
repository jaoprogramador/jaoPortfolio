{"pageProps":{"post":{"date":"2025-04-09T17:00:00.000Z","slug":"fourteen","preview":"OAuth es un est谩ndar de autorizaci贸n ampliamente utilizado para permitir que las aplicaciones accedan a recursos de usuarios sin compartir sus credenciales. En este post, te explicamos c贸mo configurar OAuth con Spring Security en una aplicaci贸n Java.","title":"OAuth con Spring Security: Autenticaci贸n y Autorizaci贸n en Aplicaciones Java","tagline":"Aprende a integrar OAuth en tus aplicaciones Java usando Spring Security.","image":"https://images.unsplash.com/photo-1618367588411-d9a90fefa881?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1074&q=80","content":"\r\n# Introducci贸n a OAuth con Spring Security\r\n\r\n**OAuth** es un protocolo de autorizaci贸n que permite a las aplicaciones acceder a recursos de un usuario en otro servicio (como Google, GitHub o LinkedIn) sin compartir sus credenciales. **Spring Security** es un framework de seguridad para aplicaciones Java que facilita la integraci贸n de OAuth en tu aplicaci贸n.\r\n\r\n## 驴Por qu茅 usar OAuth con Spring Security?\r\n\r\n1. **Seguridad**: No es necesario almacenar contrase帽as de usuarios.\r\n2. **Integraci贸n sencilla**: Spring Security proporciona soporte nativo para OAuth 2.0.\r\n3. **Escalabilidad**: Puedes integrar m煤ltiples proveedores de OAuth (Google, GitHub, etc.).\r\n\r\n---\r\n\r\n## **Configuraci贸n de OAuth con Spring Security**\r\n\r\nPara configurar OAuth en una aplicaci贸n Spring Boot, sigue estos pasos:\r\n\r\n### 1. **Agregar Dependencias**\r\n   - En tu archivo `pom.xml`, agrega las dependencias de Spring Security y OAuth:\r\n     ```xml\r\n     <dependency>\r\n         <groupId>org.springframework.boot</groupId>\r\n         <artifactId>spring-boot-starter-security</artifactId>\r\n     </dependency>\r\n     <dependency>\r\n         <groupId>org.springframework.boot</groupId>\r\n         <artifactId>spring-boot-starter-oauth2-client</artifactId>\r\n     </dependency>\r\n     ```\r\n\r\n### 2. **Configurar el Proveedor de OAuth**\r\n   - En tu archivo `application.yml` o `application.properties`, configura las credenciales de tu proveedor de OAuth (por ejemplo, Google):\r\n     ```yaml\r\n     spring:\r\n       security:\r\n         oauth2:\r\n           client:\r\n             registration:\r\n               google:\r\n                 client-id: TU_CLIENT_ID\r\n                 client-secret: TU_CLIENT_SECRET\r\n                 scope: email,profile\r\n             provider:\r\n               google:\r\n                 authorization-uri: https://accounts.google.com/o/oauth2/auth\r\n                 token-uri: https://oauth2.googleapis.com/token\r\n                 user-info-uri: https://openidconnect.googleapis.com/v1/userinfo\r\n     ```\r\n\r\n### 3. **Configurar Spring Security**\r\n   - Crea una clase de configuraci贸n para Spring Security:\r\n     ```java\r\n     import org.springframework.context.annotation.Bean;\r\n     import org.springframework.context.annotation.Configuration;\r\n     import org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\n     import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\n     import org.springframework.security.web.SecurityFilterChain;\r\n\r\n     @Configuration\r\n     @EnableWebSecurity\r\n     public class SecurityConfig {\r\n\r\n         @Bean\r\n         public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n             http\r\n                 .authorizeHttpRequests(auth -> auth\r\n                     .requestMatchers(\"/\", \"/public/**\").permitAll() // Rutas p煤blicas\r\n                     .anyRequest().authenticated() // El resto requiere autenticaci贸n\r\n                 )\r\n                 .oauth2Login(oauth2 -> oauth2\r\n                     .defaultSuccessUrl(\"/home\", true) // Redirigir despu茅s del login\r\n                 );\r\n             return http.build();\r\n         }\r\n     }\r\n     ```\r\n\r\n---\r\n\r\n## **Ejemplo Pr谩ctico: Autenticaci贸n con Google**\r\n\r\n### 1. **Crear una Aplicaci贸n en Google**\r\n   - Ve a la [Consola de Desarrolladores de Google](https://console.developers.google.com/).\r\n   - Crea un nuevo proyecto y habilita la API de OAuth 2.0.\r\n   - Configura las credenciales de OAuth (Client ID y Client Secret).\r\n   - Agrega una **Redirect URI** (por ejemplo, `http://localhost:8080/login/oauth2/code/google`).\r\n\r\n### 2. **Implementar el Controlador**\r\n   - Crea un controlador para manejar la autenticaci贸n y la p谩gina de inicio:\r\n     ```java\r\n     import org.springframework.security.core.annotation.AuthenticationPrincipal;\r\n     import org.springframework.security.oauth2.core.user.OAuth2User;\r\n     import org.springframework.stereotype.Controller;\r\n     import org.springframework.ui.Model;\r\n     import org.springframework.web.bind.annotation.GetMapping;\r\n\r\n     @Controller\r\n     public class HomeController {\r\n\r\n         @GetMapping(\"/\")\r\n         public String home() {\r\n             return \"index\"; // P谩gina de inicio p煤blica\r\n         }\r\n\r\n         @GetMapping(\"/home\")\r\n         public String userHome(@AuthenticationPrincipal OAuth2User user, Model model) {\r\n             model.addAttribute(\"name\", user.getAttribute(\"name\"));\r\n             model.addAttribute(\"email\", user.getAttribute(\"email\"));\r\n             return \"home\"; // P谩gina de inicio del usuario autenticado\r\n         }\r\n     }\r\n     ```\r\n\r\n### 3. **Crear las Vistas**\r\n   - Crea una vista `index.html` para la p谩gina p煤blica:\r\n     ```html\r\n     <!DOCTYPE html>\r\n     <html>\r\n     <head>\r\n         <title>Inicio</title>\r\n     </head>\r\n     <body>\r\n         <h1>Bienvenido</h1>\r\n         <a href=\"/oauth2/authorization/google\">Iniciar sesi贸n con Google</a>\r\n     </body>\r\n     </html>\r\n     ```\r\n\r\n   - Crea una vista `home.html` para la p谩gina del usuario autenticado:\r\n     ```html\r\n     <!DOCTYPE html>\r\n     <html>\r\n     <head>\r\n         <title>Inicio</title>\r\n     </head>\r\n     <body>\r\n         <h1>Bienvenido, <span th:text=\"${name}\"></span></h1>\r\n         <p>Correo electr贸nico: <span th:text=\"${email}\"></span></p>\r\n         <a href=\"/logout\">Cerrar sesi贸n</a>\r\n     </body>\r\n     </html>\r\n     ```\r\n\r\n---\r\n\r\n## **Conclusi贸n**\r\n\r\nSpring Security facilita la integraci贸n de OAuth en aplicaciones Java, permiti茅ndote autenticar usuarios con proveedores externos como Google, GitHub o LinkedIn. Con este ejemplo, puedes comenzar a implementar OAuth en tu aplicaci贸n Spring Boot de manera segura y eficiente.\r\n\r\n---\r\n\r\n### **Referencias**\r\n- [Documentaci贸n de Spring Security OAuth](https://docs.spring.io/spring-security/reference/servlet/oauth2/index.html)\r\n- [Gu铆a de OAuth 2.0 con Spring Boot](https://spring.io/guides/tutorials/spring-boot-oauth2/)\r\n\r\n---\r\n\r\n隆Espero que esta plantilla te sea 煤til para tu publicaci贸n sobre OAuth con Spring Security! \r\n\r\n\r\n\r\n\r\n"}},"__N_SSG":true}