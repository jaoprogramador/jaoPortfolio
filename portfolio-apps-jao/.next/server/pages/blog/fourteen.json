{"pageProps":{"post":{"date":"2025-04-09T17:00:00.000Z","slug":"fourteen","preview":"OAuth is a widely used authorization standard that allows applications to access user resources without sharing their credentials. In this post, we explain how to configure OAuth with Spring Security in a Java application.","title":"OAuth with Spring Security: Authentication and Authorization in Java Applications","tagline":"Learn how to integrate OAuth into your Java applications using Spring Security.","image":"/images/blogs/moritz-ludtke-K4n6CW8so84-unsplash.jpg","content":"\r\n# Introduction to OAuth with Spring Security\r\n\r\n**OAuth** is an authorization protocol that allows applications to access user resources on another service (such as Google, GitHub, or LinkedIn) without sharing their credentials. **Spring Security** is a security framework for Java applications that makes it easy to integrate OAuth into your application.\r\n\r\n## Why Use OAuth with Spring Security?\r\n\r\n1. **Security**: No need to store user passwords.\r\n2. **Easy Integration**: Spring Security provides native support for OAuth 2.0.\r\n3. **Scalability**: You can integrate multiple OAuth providers (Google, GitHub, etc.).\r\n\r\n---\r\n\r\n## **Setting Up OAuth with Spring Security**\r\n\r\nTo configure OAuth in a Spring Boot application, follow these steps:\r\n\r\n### 1. **Add Dependencies**\r\n   - In your `pom.xml`, add the Spring Security and OAuth dependencies:\r\n\r\n     ```xml\r\n     <dependency>\r\n         <groupId>org.springframework.boot</groupId>\r\n         <artifactId>spring-boot-starter-security</artifactId>\r\n     </dependency>\r\n     <dependency>\r\n         <groupId>org.springframework.boot</groupId>\r\n         <artifactId>spring-boot-starter-oauth2-client</artifactId>\r\n     </dependency>\r\n     ```\r\n\r\n### 2. **Configure the OAuth Provider**\r\n   - In your `application.yml` or `application.properties`, configure the credentials for your OAuth provider (e.g., Google):\r\n     ```yaml\r\n     spring:\r\n       security:\r\n         oauth2:\r\n           client:\r\n             registration:\r\n               google:\r\n                 client-id: TU_CLIENT_ID\r\n                 client-secret: TU_CLIENT_SECRET\r\n                 scope: email,profile\r\n             provider:\r\n               google:\r\n                 authorization-uri: https://accounts.google.com/o/oauth2/auth\r\n                 token-uri: https://oauth2.googleapis.com/token\r\n                 user-info-uri: https://openidconnect.googleapis.com/v1/userinfo\r\n     ```\r\n\r\n### 3. **Configure Spring Security**\r\n   - Create a configuration class for Spring Security:\r\n     ```java\r\n     import org.springframework.context.annotation.Bean;\r\n     import org.springframework.context.annotation.Configuration;\r\n     import org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\n     import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\n     import org.springframework.security.web.SecurityFilterChain;\r\n\r\n     @Configuration\r\n     @EnableWebSecurity\r\n     public class SecurityConfig {\r\n\r\n         @Bean\r\n         public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n             http\r\n                 .authorizeHttpRequests(auth -> auth\r\n                     .requestMatchers(\"/\", \"/public/**\").permitAll() // Rutas p칰blicas\r\n                     .anyRequest().authenticated() // El resto requiere autenticaci칩n\r\n                 )\r\n                 .oauth2Login(oauth2 -> oauth2\r\n                     .defaultSuccessUrl(\"/home\", true) // Redirigir despu칠s del login\r\n                 );\r\n             return http.build();\r\n         }\r\n     }\r\n     ```\r\n\r\n---\r\n\r\n## **Practical Example: Authentication with Google**\r\n\r\n### 1. **Create an Application in Google**\r\n   - Go to the [Google Developers Console](https://console.developers.google.com/).\r\n   - Create a new project and enable the OAuth 2.0 API.\r\n   - Configure the OAuth credentials (Client ID and Client Secret).\r\n   - Add a **Redirect URI** (e.g., `http://localhost:8080/login/oauth2/code/google`).\r\n\r\n### 2. **Implement the Controller**\r\n   - Create a controller to handle authentication and the home page:\r\n     ```java\r\n     import org.springframework.security.core.annotation.AuthenticationPrincipal;\r\n     import org.springframework.security.oauth2.core.user.OAuth2User;\r\n     import org.springframework.stereotype.Controller;\r\n     import org.springframework.ui.Model;\r\n     import org.springframework.web.bind.annotation.GetMapping;\r\n\r\n     @Controller\r\n     public class HomeController {\r\n\r\n         @GetMapping(\"/\")\r\n         public String home() {\r\n             return \"index\"; // P치gina de inicio p칰blica\r\n         }\r\n\r\n         @GetMapping(\"/home\")\r\n         public String userHome(@AuthenticationPrincipal OAuth2User user, Model model) {\r\n             model.addAttribute(\"name\", user.getAttribute(\"name\"));\r\n             model.addAttribute(\"email\", user.getAttribute(\"email\"));\r\n             return \"home\"; // P치gina de inicio del usuario autenticado\r\n         }\r\n     }\r\n     ```\r\n\r\n### 3. **Create the Views**\r\n   - Create an `index.html` view for the public page:\r\n     ```html\r\n     <!DOCTYPE html>\r\n     <html>\r\n     <head>\r\n         <title>Inicio</title>\r\n     </head>\r\n     <body>\r\n         <h1>Bienvenido</h1>\r\n         <a href=\"/oauth2/authorization/google\">Iniciar sesi칩n con Google</a>\r\n     </body>\r\n     </html>\r\n     ```\r\n\r\n   - Crea una vista `home.html` para la p치gina del usuario autenticado:\r\n     ```html\r\n     <!DOCTYPE html>\r\n     <html>\r\n     <head>\r\n         <title>Inicio</title>\r\n     </head>\r\n     <body>\r\n         <h1>Bienvenido, <span th:text=\"${name}\"></span></h1>\r\n         <p>Correo electr칩nico: <span th:text=\"${email}\"></span></p>\r\n         <a href=\"/logout\">Cerrar sesi칩n</a>\r\n     </body>\r\n     </html>\r\n     ```\r\n\r\n---\r\n\r\n## **Conclusion**\r\n\r\nSpring Security makes it easy to integrate OAuth into Java applications, allowing you to authenticate users with external providers like Google, GitHub, or LinkedIn. With this example, you can start implementing OAuth in your Spring Boot application securely and efficiently.\r\n\r\n---\r\n\r\n---\r\n\r\n### **References**\r\n- [Spring Security OAuth Documentation](https://docs.spring.io/spring-security/reference/servlet/oauth2/index.html)\r\n- [OAuth 2.0 Guide with Spring Boot](https://spring.io/guides/tutorials/spring-boot-oauth2/)\r\n\r\n---\r\n\r\nI hope this template is helpful for your post about OAuth with Spring Security! 游땕\r\n\r\n\r\n\r\n"}},"__N_SSG":true}